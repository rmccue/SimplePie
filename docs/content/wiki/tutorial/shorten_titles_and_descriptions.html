<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<head>
<title>SimplePie Documentation: Shorten titles and descriptions</title>

<meta name="generator" content="DokuWiki Release 2006-11-06" />
<meta name="date" content="2007-06-18T00:42:23-0700" />
<meta name="keywords" content="reference,start" />

<link rel="start" href="/wiki/" />
<link rel="contents" href="/wiki/reference/start?do=index" title="Index" />
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="/wiki/feed.php" />
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="/wiki/feed.php?mode=list&amp;ns=reference" />
<link rel="alternate" type="text/html" title="Plain HTML" href="/wiki/_export/xhtml/reference/start" />
<link rel="alternate" type="text/plain" title="Wiki Markup" href="/wiki/_export/raw/reference/start" />

<link rel="stylesheet" href="/wiki/lib/tpl/simplepie/wikistyles.css" type="text/css" media="screen">
<link rel="stylesheet" href="/css/sIFR-screen.css" type="text/css" media="screen">
<link rel="stylesheet" href="/css/sIFR-print.css" type="text/css" media="print">
<link rel="stylesheet" media="screen" type="text/css" href="/wiki/lib/exe/css.php" />
<link rel="stylesheet" media="print" type="text/css" href="/wiki/lib/exe/css.php?print=1" />

<!-- FEED HTTP-EQUIV -->
<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://feeds.feedburner.com/simplepie" />

<!-- META HTTP-EQUIV -->
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-language" content="en-us" />
<meta http-equiv="imagetoolbar" content="false" />

<!-- META NAME -->
<meta name="MSSmartTagsPreventParsing" content="true" />
<meta name="ROBOTS" content="ALL" />
<meta name="copyright" content="2004-2022 Ryan Parman, Geoffrey Sneddon" />
<meta name="description" content="A super-fast, easy-to-use, RSS and Atom parser written in PHP." />
<meta name="author" content="SimplePie.org" />
<meta name="rating" content="General" />
<meta name="revisit-after" content="2 Days" />
<meta name="doc-class" content="Living Document" />
<meta name="y_key" content="8a13570546b4e5cd" />

<!-- FAVICON -->
<link rel="shortcut icon" type="image/ico" href="/favicon.ico" />

<!-- STYLES -->
<link rel="stylesheet" href="/css/simplepie.css" media="screen, projector" />

<!-- SCRIPTS -->
<script type="text/javascript" src="/mint/?js"></script>
<script type="text/javascript" src="/scripts/sleight.js"></script>
<script type="text/javascript" src="http://www.google-analytics.com/urchin.js"></script>


<script type="text/javascript" src="/scripts/sifr.js"></script>
<script type="text/javascript" src="/scripts/sifr-config.js"></script>

</head>

<body id="bodydocs">

<div class="announcement"><a href="https://github.com/simplepie/simplepie/releases/tag/1.5">SimplePie 1.5 is now available!</a></div>
<div id="header">
	<div id="headerInner">
		<div id="logoContainer">
			<div id="logoContainerInner">
				<div id="logo"><a href="/"><img src="/images/logo_simplepie_horizontal.png" alt="SimplePie: PHP-based RSS and Atom feed handling" title="SimplePie: PHP-based RSS and Atom feed handling" border="0" /></a></div>
				<div id="feed"><form action="http://www.google.com/search" method="get"><input type="text" name="q" id="q" value="" class="text" /><input type="hidden" name="as_sitesearch" value="simplepie.org" />&nbsp;<input type="submit" value="Search" class="button" /></form></div>
				<div class="clearLeft"></div>
			</div>
		</div>
		<div id="menu">
		<table cellpadding="0" cellspacing="0" border="0"><tbody><tr><td>
<ul><li id="overview"><a href="/">Overview</a></li><li id="demo"><a href="/demo/">Demo</a></li><li id="blog"><a href="/blog/">Blog</a></li><li id="downloads"><a href="/downloads/">Download</a></li><li id="docs"><a href="/wiki/">Documentation</a></li><li id="api"><a href="/api/">API Docs</a></li><li id="support"><a href="/support/">Support</a></li><li id="bugs"><a href="http://github.com/simplepie/simplepie/issues">Issue Tracker</a></li><li id="faq"><a href="/wiki/faq/start">FAQ</a></li></ul>
			<div class="clearLeft"></div>
		</td></tr></tbody></table>
		</div>
	</div>
</div>

<div id="site">

	<div id="content">

		<div class="chunk">
			<h2 class="image"><img src="/images/copy_simplepie_documentation.gif" alt="SimplePie Documentation.  Learn how to use this thing.  It's way better than going to school." title="SimplePie Documentation.  Learn how to use this thing.  It's way better than going to school." /></h2>
		</div>

		<div class="chunk focus" id="controls">
			<div class="buttons">
				<form class="button btn_source" method="post" action="/wiki/tutorial/shorten_titles_and_descriptions"><div class="no"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="" /><input type="submit" value="Show pagesource" class="button" accesskey="v" title="Show pagesource [V]" /></div></form>				<form class="button btn_revs" method="get" action="/wiki/tutorial/shorten_titles_and_descriptions"><div class="no"><input type="hidden" name="do" value="revisions" /><input type="submit" value="Old revisions" class="button" accesskey="o" title="Old revisions [O]" /></div></form>				<form class="button btn_recent" method="get" action="/wiki/tutorial/shorten_titles_and_descriptions"><div class="no"><input type="hidden" name="do" value="recent" /><input type="submit" value="Recent changes" class="button" accesskey="r" title="Recent changes [R]" /></div></form>																<form class="button btn_login" method="get" action="/wiki/tutorial/shorten_titles_and_descriptions"><div class="no"><input type="hidden" name="do" value="login" /><input type="hidden" name="sectok" value="843d28224ea925a01f1468f4eb5db37c" /><input type="submit" value="Login" class="button" title="Login" /></div></form>			</div>
			<div class="search">
				<form action="/wiki/" accept-charset="utf-8" class="search" id="dw__search" method="get"><div class="no"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]" /><input type="submit" value="Search" class="button" title="Search" /><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>			</div>
			<div class="clearRight"></div>
		</div>

		<p class="footnote"><span class="bchead">You are here: </span><a href="/wiki/start"  title="start">Documentation</a> &raquo; <a href="/wiki/tutorial/start"  title="tutorial:start">Tips, Tricks, Tutorials, and Screencasts</a> &raquo; <a href="/wiki/tutorial/shorten_titles_and_descriptions"  title="tutorial:shorten_titles_and_descriptions">Shorten titles and descriptions</a></p>

		<div class="chunk">

	    	<!-- TOC START -->
<div class="toc">
<div class="tocheader toctoggle" id="toc__header">Table of Contents</div>
<div id="toc__inside">

<ul class="toc">
<li class="level1"><div class="li"><span class="li"><a href="#shorten_titles_and_descriptions" class="toc">Shorten titles and descriptions</a></span></div>
<ul class="toc">
<li class="level2"><div class="li"><span class="li"><a href="#compatibility" class="toc">Compatibility</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="#code_source" class="toc">Code source</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="#example_usage" class="toc">Example Usage</a></span></div></li></ul>
</li></ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1"><a name="shorten_titles_and_descriptions" id="shorten_titles_and_descriptions">Shorten titles and descriptions</a></h1>
<div class="level1">

<p>
<strong>There have been approximately 100 Jillion-Kabillion-Bazillion support questions asked about shortening titles and descriptions.</strong>
</p>
<ul>
<li class="level1"><div class="li"> Some people want to break at a certain number of characters.</div>
</li>
<li class="level1"><div class="li"> Some people want to break at a certain number of characters, but don&#039;t want to break words.</div>
</li>
<li class="level1"><div class="li"> Some people want to break after a certain number of words.</div>
</li>
<li class="level1"><div class="li"> Some people want to break after a certain number of sentences.</div>
</li>
<li class="level1"><div class="li"> Some people want to do all of these things and maintain <acronym title="HyperText Markup Language">HTML</acronym> and entities.</div>
</li>
<li class="level1"><div class="li"> Some people want 100 Jillion-Kabillion-Bazillion dollars/pounds/euros/yen/pesos/whatever.</div>
</li>
</ul>

<p>

We had made some good progress on on this back in Summer 2006 while we were working on what would eventually become SimplePie Beta 3.  We were trying to shorten descriptions by character, word, or sentence, with the ability to preserve <acronym title="HyperText Markup Language">HTML</acronym> and entities.  We had something that kinda worked, but it was very buggy and unreliable so we scrapped it in its then-current form.  We decided to push that feature off until we moved to the much more reliable <acronym title="Hypertext Preprocessor">PHP</acronym> <acronym title="Document Object Model">DOM</acronym> extension, which is currently slated for our SimplePie 2.0 release (which we plan to build from the ground-up to be <acronym title="Hypertext Preprocessor">PHP</acronym> 5/6 compatible, ridiculously fast, and more extensible than WordPress – things which are unrealistically challenging with our current PHP4-friendly codebase).
</p>

<p>
The solution is not as simple as you might think it would be, so here&#039;s the SIMPLEST solution.
</p>

</div>

<h2 class="sectionedit2"><a name="compatibility" id="compatibility">Compatibility</a></h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> Supported in SimplePie 1.0.</div>
</li>
<li class="level1"><div class="li"> Code in this tutorial should be compatible with <acronym title="Hypertext Preprocessor">PHP</acronym> 4.3 or newer, and should not use <acronym title="Hypertext Preprocessor">PHP</acronym> short tags, in order to support the largest number of <acronym title="Hypertext Preprocessor">PHP</acronym> installations.</div>
</li>
</ul>

</div>

<h2 class="sectionedit3"><a name="code_source" id="code_source">Code source</a></h2>
<div class="level2">

<p>
This solution does the following things:
</p>
<ul>
<li class="level1"><div class="li"> Strips ALL <acronym title="HyperText Markup Language">HTML</acronym> (to get an accurate character count)</div>
</li>
<li class="level1"><div class="li"> Shortens the text by NUMBER OF CHARACTERS; Not by word, sentence, or anything else.</div>
</li>
<li class="level1"><div class="li"> Looks at where the text breaks, and makes an attempt to append the correct ending punctuation (an ellipsis, unless we broke where a sentence was already ending).</div>
</li>
<li class="level1"><div class="li"> It does NOT take <acronym title="HyperText Markup Language">HTML</acronym> entities into account.</div>
</li>
<li class="level1"><div class="li"> This code is NOT SimplePie-specific and can be used in any <acronym title="Hypertext Preprocessor">PHP</acronym> context.</div>
</li>
<li class="level1"><div class="li"> If you&#039;re looking for variations on this script, you can do a forum search for “shorten” or “truncate”, or look at the comments posted at <a href="http://php.net/substr" class="urlextern" title="http://php.net/substr"  rel="nofollow">http://php.net/substr</a>.</div>
</li>
</ul>
<pre class="code php"><span class="kw2">&lt;?php</span>
<span class="kw2">function</span> shorten<span class="br0">&#40;</span><span class="re0">$string</span><span class="sy0">,</span> <span class="re0">$length</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    <span class="co1">// By default, an ellipsis will be appended to the end of the text.</span>
    <span class="re0">$suffix</span> <span class="sy0">=</span> <span class="st_h">'&amp;hellip;'</span><span class="sy0">;</span>
&nbsp;
    <span class="co1">// Convert 'smart' punctuation to 'dumb' punctuation, strip the HTML tags,</span>
    <span class="co1">// and convert all tabs and line-break characters to single spaces.</span>
    <span class="re0">$short_desc</span> <span class="sy0">=</span> <a href="http://www.php.net/trim"><span class="kw3">trim</span></a><span class="br0">&#40;</span><a href="http://www.php.net/str_replace"><span class="kw3">str_replace</span></a><span class="br0">&#40;</span><a href="http://www.php.net/array"><span class="kw3">array</span></a><span class="br0">&#40;</span><span class="st0">&quot;<span class="es1">\r</span>&quot;</span><span class="sy0">,</span><span class="st0">&quot;<span class="es1">\n</span>&quot;</span><span class="sy0">,</span> <span class="st0">&quot;<span class="es1">\t</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="st_h">' '</span><span class="sy0">,</span> <a href="http://www.php.net/strip_tags"><span class="kw3">strip_tags</span></a><span class="br0">&#40;</span><span class="re0">$string</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="co1">// Cut the string to the requested length, and strip any extraneous spaces </span>
    <span class="co1">// from the beginning and end.</span>
    <span class="re0">$desc</span> <span class="sy0">=</span> <a href="http://www.php.net/trim"><span class="kw3">trim</span></a><span class="br0">&#40;</span><a href="http://www.php.net/substr"><span class="kw3">substr</span></a><span class="br0">&#40;</span><span class="re0">$short_desc</span><span class="sy0">,</span> <span class="nu0">0</span><span class="sy0">,</span> <span class="re0">$length</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="co1">// Find out what the last displayed character is in the shortened string</span>
    <span class="re0">$lastchar</span> <span class="sy0">=</span> <a href="http://www.php.net/substr"><span class="kw3">substr</span></a><span class="br0">&#40;</span><span class="re0">$desc</span><span class="sy0">,</span> <span class="sy0">-</span><span class="nu0">1</span><span class="sy0">,</span> <span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="co1">// If the last character is a period, an exclamation point, or a question </span>
    <span class="co1">// mark, clear out the appended text.</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span><span class="re0">$lastchar</span> <span class="sy0">==</span> <span class="st_h">'.'</span> <span class="sy0">||</span> <span class="re0">$lastchar</span> <span class="sy0">==</span> <span class="st_h">'!'</span> <span class="sy0">||</span> <span class="re0">$lastchar</span> <span class="sy0">==</span> <span class="st_h">'?'</span><span class="br0">&#41;</span> <span class="re0">$suffix</span><span class="sy0">=</span><span class="st_h">''</span><span class="sy0">;</span>
&nbsp;
    <span class="co1">// Append the text.</span>
    <span class="re0">$desc</span> <span class="sy0">.=</span> <span class="re0">$suffix</span><span class="sy0">;</span>
&nbsp;
    <span class="co1">// Send the new description back to the page.</span>
    <span class="kw1">return</span> <span class="re0">$desc</span><span class="sy0">;</span>
<span class="br0">&#125;</span>
<span class="sy1">?&gt;</span></pre>

</div>

<h2 class="sectionedit4"><a name="example_usage" id="example_usage">Example Usage</a></h2>
<div class="level2">
<pre class="code php"><span class="kw2">&lt;?php</span>
&nbsp;
<span class="co1">// Shorten the text to 150 characters.</span>
<span class="kw1">echo</span> shorten<span class="br0">&#40;</span><span class="re0">$item</span><span class="sy0">-&gt;</span><span class="me1">get_description</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="nu0">150</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="sy1">?&gt;</span></pre>

</div>


			<div class="clearRight"></div>
			<div align="right"><br /><span class="footnote"> tutorial/shorten_titles_and_descriptions.txt &middot; Last modified: 2011/03/06 03:56 (external edit)</span></div>

		</div>

		<div id="footer">
<p class="highlight" style="background-color:#ffc; border-bottom:1px solid #ccc;"><strong>Show some love!</strong> Wishlists for <a href="http://www.amazon.co.uk/gp/registry/wishlist/2ASV4RHBSM16H/026-9090951-0551667">Geoffrey</a>, <a href="http://www.amazon.com/gp/registry/wishlist/KAFYR57E8R81/">Ryan P.</a>, and <a href="http://www.amazon.com/gp/registry/wishlist/2P9RS76SG0UHL/">Ryan M.</a></p>
<p class="footnote">SimplePie is &copy; 2004&ndash;2022 <a href="http://ryanparman.com">Ryan Parman</a>, <a href="http://gsnedders.com/">Geoffrey Sneddon</a>, <a href="http://ryanmccue.info/">Ryan McCue</a> and contributors.  Licensed under the <a href="http://www.opensource.org/licenses/bsd-license.php">BSD License</a>.  Hosted thanks to <a href="http://ma.tt/">Matt Mullenweg</a>, powered by <a href="http://wordpress.org">WordPress</a> and <a href="http://php.net">PHP 5.6.40</a>, and managed with <a href="http://basecamphq.com/?referrer=skyzyx">Basecamp</a>.  Syndication handled by <a href="http://simplepie.org" title="SimplePie 1.5">SimplePie</a>.  Variation on the Feed Icon by <a href="http://www.bartelme.at/journal/archive/feed_icon_template">Wolfgang Bartelme</a>.</p>
<div class="spacer"></div>
</div>
<script type="text/javascript">_uacct = "UA-1004552-1";urchinTracker();</script>

	</div>

</div>

<div class="no"><img src="/wiki/lib/exe/indexer.php?id=tutorial%3Ashorten_titles_and_descriptions&amp;1666873866" width="1" height="1" alt=""  /></div>

</body>
</html>